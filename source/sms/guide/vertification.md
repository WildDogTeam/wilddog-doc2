title: 验证码短信
---


## 准备工作
- 创建应用。首先，你需要在控制面板中创建应用。请参考 [控制面板-创建应用](/console/creat.html)。
- 账户充值。为防止滥用，短信服务需帐户余额大于 5 元才能使用。如余额不足，请进入 [控制面板-财务-充值](https://www.wilddog.com/pay/recharge) 进行充值。

 
## 配置短信

验证码短信需配置三部分: 签名、模版、变量。

### 配置签名

签名出现在你下发短信的开头，实际效果如下图中的【野狗实时】。签名可以是你的公司简称，品牌名或网站名。通过 控制面板-短信-签名 配置短信签名，同时需要提交相关资质，审核通过后可使用。

![](/images/smssignature.jpg)

<blockquote class="notice">
  <p><strong>提示：</strong></p>
  <li>短信签名默认为【野狗试用】。</li>
  <li>每一个应用只能创建一个短信签名。</li>
  <li>更改签名需要在 控制面板-短信-签名 页面中提交相关资质。</li>
  <li>签名提交后需审核，在审核期间可以使用旧的签名发送短信。</li>
</blockquote>


### 配置模版

#### 选择野狗提供的模版

你可以使用野狗提供的验证码模版。目前野狗提供两种模版，可分别于`验证号码`和`重置密码`场景。 模版内容由固定内容和一个 6 位验证码组成，验证码由野狗生成和校验。使用过程如下:

![](/images/vertiprocess.jpg)


<blockquote class="notice">
  <p><strong>提示：</strong></p>
  <li>验证码模版需要调用短信模板 ID。</li>
  <li>验证码有效时间默认为 10 分钟。</li>
</blockquote>


野狗提供的验证码模版如下：

![](/images/smsmode.jpg)

该模版可用于：

- 注册时发送验证码短信
- 登录时发送验证码短信
- 找回/修改密码时发送验证码短信
- 绑定银行/实名认证时发送验证码短信等。


#### 自定义验证码模版
你也可以自定义验证码模版，需要自行生成和校验验证码。配置模版内容需要带有关键字`验证码`以及至少一个`%s`。 并且自行生成的验证码需要是 6 位数字。每个用户可以用变量来替换部分内容，每个应用最多创建 50 条验证码模版。配置的验证码模版需要提交审核。使用过程如下:

![](/images/smsmode2.jpg)

通过 控制面板-短信-模板 创建验证码短信模板，操作如下:

![](/images/creatmode.jpg)

点击`添加模版`后开始自定义验证码模版

![](/images/creatmode2.jpg)

#### 配置变量

野狗短信提供的模板短信由固定内容与多个变量构成，其中 `%s` 为需要接口替换的变量，发送短信时，接口会按顺序依次传入要替换的变量。

|参数           |类型           |必选       |说明|
|--------------|--------------|----------|---|
|params           |string         |否         |短信参数列表，用于依次填充模板，JSONArray格式，如["xxx","yyy"];对于不包含变量的模板，表示模板即短信全文内容。|

<blockquote class="notice">
  <p><strong>提示：</strong></p>
  <li>变量内容可以是汉字、字母、数字或者特殊字符。 </li>
  <li>单个变量内容长度不得超过30个字。</li>
  <li>一条模板短信中变量数量不限制，但不能连续使用5个变量。</li>
</blockquote>

例如，配置变量如下：

```
你正在修改密码，验证码是%s。 此时 params 为["111111"]

```

### 短信字符限制
短信可分为普通短信和长短信：

- 普通短信每条限制 70 个字符。

- 超过 70 个字符即为长短信，长短信最多支持 300 个字符。每条长短信将被拆分，其中每条信息限制为 67 个字符。

例如：一条 134 个字符的长短信，将被拆分为（67个字符+67个字符） 共 2 条信息，同时按两条普通短信计费。


## 配置上行接口（选配）

配置上行接口用于获取用户短信发送状态以及用户回复内容。可选择配置，默认关闭。

你需要提供一个公网可访问的 http 接口地址，在 控制面板-短信-用户回复 中配置为推送地址。如下：

![](/images/smsfeedback.jpg)

<blockquote class="notice">
  <p><strong>提示：</strong></p>
  <li>如果连续 5 次接口请求失败，上行功能将被禁用，需要在控制面板重新开启。</li>
  <li>你需要保证接口的安全性，以防止恶意调用。</li>
</blockquote>

在返回状态或上行时，系统会调用该地址，将状态或上行以 JSON 形式，推送给你，你应该获取整个 post 内容，进行数据解析。

例如，返回状态数据格式如下：

```
{
  "data": [
    {
      "status": "Success", //Success代表成功 Failure代表失败
      "deliveryStatus": "DELIVRD",
      "mobile": "xxxxxxxxxxx",
      "rrid": "$rrid",
      "receiveTime": "2016-12-28 14:43:21"
    }
  ],
  "type": 1 //type为1代表状态类型
}
```

短信上行数据格式如下：

```
{
  "data": [
    {
      "content": "回复内容",
      "mobile": "xxxxxxxxxxx",
      "rrid": "$rrid",
      "receiveTime": "2016-12-28 15:18:30",
      "extno": "0001"
    }
  ],
  "type": 3 //type为3代表通知类或验证码类上行类型
}
```

## 调用接口

- 需生成 [数字签名](/sms/guide/signature.html#生成数字签名的方法) 及调用接口，请参考 [接口文档](/sms/api/sendcode.html)。
- 如需校验验证码和查询短信发送状态，请参考 [校验验证码](/sms/api/checkcode.html) 、[查询发送状态](/sms/api/status.html)。